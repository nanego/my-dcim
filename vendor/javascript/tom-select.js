var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};(function(e,i){t=i()})(0,(function(){function forEvents(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}class MicroEvent{constructor(){this._events={}}on(e,t){forEvents(e,(e=>{this._events[e]=this._events[e]||[];this._events[e].push(t)}))}off(e,t){var i=arguments.length;0!==i?forEvents(e,(e=>{if(1===i)return delete this._events[e];e in this._events!==false&&this._events[e].splice(this._events[e].indexOf(t),1)})):this._events={}}trigger(e,...t){var i=this;forEvents(e,(e=>{if(e in i._events!==false)for(let s of i._events[e])s.apply(i,t)}))}}function MicroPlugin(e){e.plugins={};return class extends e{constructor(...e){super(...e);this.plugins={names:[],settings:{},requested:{},loaded:{}}}
/**
       * Registers a plugin.
       *
       * @param {function} fn
       */static define(t,i){e.plugins[t]={name:t,fn:i}}
/**
       * Initializes the listed plugins (with options).
       * Acceptable formats:
       *
       * List (without options):
       *   ['a', 'b', 'c']
       *
       * List (with options):
       *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]
       *
       * Hash (with options):
       *   {'a': { ... }, 'b': { ... }, 'c': { ... }}
       *
       * @param {array|object} plugins
       */initializePlugins(e){var t,i;const s=this;const n=[];if(Array.isArray(e))e.forEach((e=>{if("string"===typeof e)n.push(e);else{s.plugins.settings[e.name]=e.options;n.push(e.name)}}));else if(e)for(t in e)if(e.hasOwnProperty(t)){s.plugins.settings[t]=e[t];n.push(t)}while(i=n.shift())s.require(i)}loadPlugin(t){var i=this;var s=i.plugins;var n=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');s.requested[t]=true;s.loaded[t]=n.fn.apply(i,[i.plugins.settings[t]||{}]);s.names.push(t)}require(e){var t=this;var i=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(i.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return i.loaded[e]}}}var t;const i="[̀-ͯ·ʾ]";const s=new RegExp(i,"g");var n;const r={"æ":"ae","ⱥ":"a","ø":"o"};const o=new RegExp(Object.keys(r).join("|"),"g");const l=[[67,67],[160,160],[192,438],[452,652],[961,961],[1019,1019],[1083,1083],[1281,1289],[1984,1984],[5095,5095],[7429,7441],[7545,7549],[7680,7935],[8580,8580],[9398,9449],[11360,11391],[42792,42793],[42802,42851],[42873,42897],[42912,42922],[64256,64260],[65313,65338],[65345,65370]];const asciifold=e=>e.normalize("NFKD").replace(s,"").toLowerCase().replace(o,(function(e){return r[e]}));const arrayToPattern=(e,t="|")=>e.length>1?"(?:"+e.join(t)+")":e[0];const allSubstrings=e=>{if(1===e.length)return[[e]];var t=[];allSubstrings(e.substring(1)).forEach((function(i){var s=i.slice(0);s[0]=e.charAt(0)+s[0];t.push(s);s=i.slice(0);s.unshift(e.charAt(0));t.push(s)}));return t};const generateDiacritics=()=>{var e={};l.forEach((t=>{for(let i=t[0];i<=t[1];i++){let t=String.fromCharCode(i);let s=asciifold(t);if(s!=t.toLowerCase()){s in e||(e[s]=[s]);e[s].push(t)}}}));var s=Object.keys(e);s=s.sort(((e,t)=>t.length-e.length));t=new RegExp("("+arrayToPattern(s)+i+"*)","g");var n={};s.sort(((e,t)=>e.length-t.length)).forEach((t=>{var i=allSubstrings(t);var s=i.map((t=>{t=t.map((t=>e.hasOwnProperty(t)?arrayToPattern(e[t]):t));return arrayToPattern(t,"")}));n[t]=arrayToPattern(s)}));return n};const diacriticRegexPoints=e=>{void 0===n&&(n=generateDiacritics());const i=e.normalize("NFKD").toLowerCase();return i.split(t).map((e=>{if(""==e)return"";const t=asciifold(e);if(n.hasOwnProperty(t))return n[t];const i=e.normalize("NFC");return i!=e?arrayToPattern([e,i]):e})).join("")};
/**
   * A property getter resolving dot-notation
   * @param  {Object}  obj     The root object to fetch property on
   * @param  {String}  name    The optionally dotted property name to fetch
   * @return {Object}          The resolved property value
   */const getAttr=(e,t)=>{if(e)return e[t]};
/**
   * A property getter resolving dot-notation
   * @param  {Object}  obj     The root object to fetch property on
   * @param  {String}  name    The optionally dotted property name to fetch
   * @return {Object}          The resolved property value
   */const getAttrNesting=(e,t)=>{if(e){var i,s=t.split(".");while((i=s.shift())&&(e=e[i]));return e}};const scoreValue=(e,t,i)=>{var s,n;if(!e)return 0;e+="";n=e.search(t.regex);if(-1===n)return 0;s=t.string.length/e.length;0===n&&(s+=.5);return s*i};const escape_regex=e=>(e+"").replace(/([\$\(-\+\.\?\[-\^\{-\}])/g,"\\$1");const propToArray=(e,t)=>{var i=e[t];i&&!Array.isArray(i)&&(e[t]=[i])};const iterate=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)};const cmp=(e,t)=>{if("number"===typeof e&&"number"===typeof t)return e>t?1:e<t?-1:0;e=asciifold(e+"").toLowerCase();t=asciifold(t+"").toLowerCase();return e>t?1:t>e?-1:0};class Sifter{constructor(e,t){this.items=e;this.settings=t||{diacritics:true}}tokenize(e,t,i){if(!e||!e.length)return[];const s=[];const n=e.split(/\s+/);var r;i&&(r=new RegExp("^("+Object.keys(i).map(escape_regex).join("|")+"):(.*)$"));n.forEach((e=>{let i;let n=null;let o=null;if(r&&(i=e.match(r))){n=i[1];e=i[2]}if(e.length>0){o=escape_regex(e);this.settings.diacritics&&(o=diacriticRegexPoints(o));t&&(o="\\b"+o)}s.push({string:e,regex:o?new RegExp(o,"iu"):null,field:n})}));return s}
/**
     * Returns a function to be used to score individual results.
     *
     * Good matches will have a higher score than poor matches.
     * If an item is not a match, 0 will be returned by the function.
     *
     * @returns {function}
     */getScoreFunction(e,t){var i=this.prepareSearch(e,t);return this._getScoreFunction(i)}_getScoreFunction(e){const t=e.tokens,i=t.length;if(!i)return function(){return 0};const s=e.options.fields,n=e.weights,r=s.length,o=e.getAttrFn;if(!r)return function(){return 1};const l=function(){return 1===r?function(e,t){const i=s[0].field;return scoreValue(o(t,i),e,n[i])}:function(e,t){var i=0;if(e.field){const s=o(t,e.field);!e.regex&&s?i+=1/r:i+=scoreValue(s,e,1)}else iterate(n,((s,n)=>{i+=scoreValue(o(t,n),e,s)}));return i/r}}();return 1===i?function(e){return l(t[0],e)}:"and"===e.options.conjunction?function(e){var s,n=0,r=0;for(;n<i;n++){s=l(t[n],e);if(s<=0)return 0;r+=s}return r/i}:function(e){var s=0;iterate(t,(t=>{s+=l(t,e)}));return s/i}}getSortFunction(e,t){var i=this.prepareSearch(e,t);return this._getSortFunction(i)}_getSortFunction(e){var t,i,s;const n=this,r=e.options,o=!e.query&&r.sort_empty?r.sort_empty:r.sort,l=[],a=[];const c=function get_field(t,i){return"$score"===t?i.score:e.getAttrFn(n.items[i.id],t)};if(o)for(t=0,i=o.length;t<i;t++)(e.query||"$score"!==o[t].field)&&l.push(o[t]);if(e.query){s=true;for(t=0,i=l.length;t<i;t++)if("$score"===l[t].field){s=false;break}s&&l.unshift({field:"$score",direction:"desc"})}else for(t=0,i=l.length;t<i;t++)if("$score"===l[t].field){l.splice(t,1);break}for(t=0,i=l.length;t<i;t++)a.push("desc"===l[t].direction?-1:1);const d=l.length;if(d){if(1===d){const e=l[0].field;const t=a[0];return function(i,s){return t*cmp(c(e,i),c(e,s))}}return function(e,t){var i,s,n;for(i=0;i<d;i++){n=l[i].field;s=a[i]*cmp(c(n,e),c(n,t));if(s)return s}return 0}}return null}prepareSearch(e,t){const i={};var s=Object.assign({},t);propToArray(s,"sort");propToArray(s,"sort_empty");if(s.fields){propToArray(s,"fields");const e=[];s.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1});e.push(t);i[t.field]="weight"in t?t.weight:1}));s.fields=e}return{options:s,query:e.toLowerCase().trim(),tokens:this.tokenize(e,s.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:s.nesting?getAttrNesting:getAttr}}search(e,t){var i,s,n=this;s=this.prepareSearch(e,t);t=s.options;e=s.query;const r=t.score||n._getScoreFunction(s);e.length?iterate(n.items,((e,n)=>{i=r(e);(false===t.filter||i>0)&&s.items.push({score:i,id:n})})):iterate(n.items,((e,t)=>{s.items.push({score:1,id:t})}));const o=n._getSortFunction(s);o&&s.items.sort(o);s.total=s.items.length;"number"===typeof t.limit&&(s.items=s.items.slice(0,t.limit));return s}}const getDom=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(e.indexOf("<")>-1){let t=document.createElement("div");t.innerHTML=e.trim();return t.firstChild}return document.querySelector(e)};const escapeQuery=e=>e.replace(/['"\\]/g,"\\$&");const triggerEvent=(e,t)=>{var i=document.createEvent("HTMLEvents");i.initEvent(t,true,false);e.dispatchEvent(i)};const applyCSS=(e,t)=>{Object.assign(e.style,t)};const addClasses=(e,...t)=>{var i=classesArray(t);e=castAsArray(e);e.map((e=>{i.map((t=>{e.classList.add(t)}))}))};const removeClasses=(e,...t)=>{var i=classesArray(t);e=castAsArray(e);e.map((e=>{i.map((t=>{e.classList.remove(t)}))}))};const classesArray=e=>{var t=[];for(let i of e){"string"===typeof i&&(i=i.trim().split(/[\11\12\14\15\40]/));Array.isArray(i)&&(t=t.concat(i))}return t.filter(Boolean)};const castAsArray=e=>{Array.isArray(e)||(e=[e]);return e};const parentMatch=(e,t,i)=>{if(!i||i.contains(e))while(e&&e.matches){if(e.matches(t))return e;e=e.parentNode}};const getTail=(e,t=0)=>t>0?e[e.length-1]:e[0];const isEmptyObject=e=>0===Object.keys(e).length;const nodeIndex=(e,t)=>{if(!e)return-1;t=t||e.nodeName;var i=0;while(e=e.previousElementSibling)e.matches(t)&&i++;return i};const setAttr=(e,t)=>{for(const i in t){let s=t[i];null==s?e.removeAttribute(i):e.setAttribute(i,""+s)}};const replaceNode=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)};const highlight=(e,t)=>{if(null===t)return;if("string"===typeof t){if(!t.length)return;t=new RegExp(t,"i")}const highlightText=e=>{var i=e.data.match(t);if(i&&e.data.length>0){var s=document.createElement("span");s.className="highlight";var n=e.splitText(i.index);n.splitText(i[0].length);var r=n.cloneNode(true);s.appendChild(r);replaceNode(n,s);return 1}return 0};const highlightChildren=e=>{if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var t=0;t<e.childNodes.length;++t)t+=highlightRecursive(e.childNodes[t])};const highlightRecursive=e=>{if(3===e.nodeType)return highlightText(e);highlightChildren(e);return 0};highlightRecursive(e)};const removeHighlight=e=>{var t=e.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e);t.normalize()}))};const a=65;const c=13;const d=27;const u=37;const p=38;const h=39;const g=40;const f=8;const v=46;const m=9;const y="undefined"!==typeof navigator&&/Mac/.test(navigator.userAgent);const O=y?"metaKey":"ctrlKey";var b={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:true,diacritics:true,create:null,createOnBlur:false,createFilter:null,highlight:true,openOnFocus:true,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:false,addPrecedence:false,selectOnTab:false,preload:null,allowEmptyOption:false,closeAfterSelect:false,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:false,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-control",inputClass:"ts-input",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:null,copyClassesToDropdown:true,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};const hash_key=e=>"undefined"===typeof e||null===e?null:get_hash(e);const get_hash=e=>"boolean"===typeof e?e?"1":"0":e+"";const escape_html=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");const loadDebounce=(t,i)=>{var s;return function(n,r){var o=this||e;if(s){o.loading=Math.max(o.loading-1,0);clearTimeout(s)}s=setTimeout((function(){s=null;o.loadedSearches[n]=true;t.call(o,n,r)}),i)}};const debounce_events=(e,t,i)=>{var s;var n=e.trigger;var r={};e.trigger=function(){var i=arguments[0];if(-1===t.indexOf(i))return n.apply(e,arguments);r[i]=arguments};i.apply(e,[]);e.trigger=n;for(s in r)n.apply(e,r[s])};const getSelection=e=>({start:e.selectionStart||0,length:(e.selectionEnd||0)-(e.selectionStart||0)});const preventDefault=(e,t=false)=>{if(e){e.preventDefault();t&&e.stopPropagation()}};const addEvent=(e,t,i,s)=>{e.addEventListener(t,i,s)};const isKeyDown=(e,t)=>{if(!t)return false;if(!t[e])return false;var i=(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0);return 1===i};const getId=(e,t)=>{const i=e.getAttribute("id");if(i)return i;e.setAttribute("id",t);return t};const addSlashes=e=>e.replace(/[\\"']/g,"\\$&");const append=(e,t)=>{t&&e.append(t)};function getSettings(e,t){var i=Object.assign({},b,t);var s=i.dataAttr;var n=i.labelField;var r=i.valueField;var o=i.disabledField;var l=i.optgroupField;var a=i.optgroupLabelField;var c=i.optgroupValueField;var d=e.tagName.toLowerCase();var u=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!u&&!i.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(u=t.textContent)}var p={placeholder:u,options:[],optgroups:[],items:[],maxItems:null};var init_select=()=>{var t;var d=p.options;var u={};var h=1;var readData=e=>{var t=Object.assign({},e.dataset);var i=s&&t[s];"string"===typeof i&&i.length&&(t=Object.assign(t,JSON.parse(i)));return t};var addOption=(e,t)=>{var s=hash_key(e.value);if(null!=s&&(s||i.allowEmptyOption)){if(u.hasOwnProperty(s)){if(t){var a=u[s][l];a?Array.isArray(a)?a.push(t):u[s][l]=[a,t]:u[s][l]=t}}else{var c=readData(e);c[n]=c[n]||e.textContent;c[r]=c[r]||s;c[o]=c[o]||e.disabled;c[l]=c[l]||t;c.$option=e;u[s]=c;d.push(c)}e.selected&&p.items.push(s)}};var addGroup=e=>{var t,i;i=readData(e);i[a]=i[a]||e.getAttribute("label")||"";i[c]=i[c]||h++;i[o]=i[o]||e.disabled;p.optgroups.push(i);t=i[c];for(const i of e.children)addOption(i,t)};p.maxItems=e.hasAttribute("multiple")?null:1;for(const i of e.children){t=i.tagName.toLowerCase();"optgroup"===t?addGroup(i):"option"===t&&addOption(i)}};var init_textbox=()=>{const t=e.getAttribute(s);if(t){p.options=JSON.parse(t);for(const e of p.options)p.items.push(e[r])}else{var o=e.value.trim()||"";if(!i.allowEmptyOption&&!o.length)return;const t=o.split(i.delimiter);for(const e of t){const t={};t[n]=e;t[r]=e;p.options.push(t)}p.items=t}};"select"===d?init_select():init_textbox();return Object.assign({},b,p,t)}var w=0;class TomSelect extends(MicroPlugin(MicroEvent)){constructor(e,t){super();this.order=0;this.tab_key=false;this.isOpen=false;this.isDisabled=false;this.isInvalid=false;this.isLocked=false;this.isFocused=false;this.isInputHidden=false;this.isSetup=false;this.ignoreFocus=false;this.hasOptions=false;this.lastValue="";this.caretPos=0;this.loading=0;this.loadedSearches={};this.activeOption=null;this.activeItems=[];this.optgroups={};this.options={};this.userOptions={};this.items=[];this.renderCache={item:{},option:{}};w++;var i;var s=getDom(e);var n=this;if(s.tomselect)throw new Error("Tom Select already initialized on this element");s.tomselect=this;var r=window.getComputedStyle&&window.getComputedStyle(s,null);i=r.getPropertyValue("direction");this.settings=getSettings(s,t);this.input=s;this.tabIndex=s.tabIndex||0;this.is_select_tag="select"===s.tagName.toLowerCase();this.rtl=/rtl/i.test(i);this.inputId=getId(s,"tomselect-"+w);this.isRequired=s.required;this.sifter=new Sifter(this.options,{diacritics:this.settings.diacritics});this.setupOptions(this.settings.options,this.settings.optgroups);delete this.settings.optgroups;delete this.settings.options;this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi");"boolean"!==typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode);"boolean"!==typeof this.settings.hidePlaceholder&&(this.settings.hidePlaceholder="multi"!==this.settings.mode);var o=this.settings.createFilter;if("function"!==typeof o){"string"===typeof o&&(o=new RegExp(o));o instanceof RegExp?this.settings.createFilter=e=>o.test(e):this.settings.createFilter=()=>true}this.initializePlugins(this.settings.plugins);this.setupCallbacks();this.setupTemplates();t=n.settings;var l;var a;var c;var d;var u;var p;var h;var g;s=n.input;var f;const v={passive:true};const m=n.inputId+"-ts-dropdown";p=n.settings.mode;h=s.getAttribute("class")||"";l=getDom("<div>");addClasses(l,t.wrapperClass,h,p);a=getDom('<div class="items">');addClasses(a,t.inputClass);append(l,a);d=n._render("dropdown");addClasses(d,t.dropdownClass,p);u=getDom(`<div role="listbox" id="${m}" tabindex="-1">`);addClasses(u,t.dropdownContentClass);append(d,u);getDom(t.dropdownParent||l).appendChild(d);if(t.controlInput)c=getDom(t.controlInput);else{c=getDom('<input type="text" autocomplete="off" size="1" />');var y=["autocorrect","autocapitalize","autocomplete"];for(const e of y)s.getAttribute(e)&&setAttr(c,{[e]:s.getAttribute(e)})}if(!t.controlInput){c.tabIndex=s.disabled?-1:n.tabIndex;a.appendChild(c)}setAttr(c,{role:"combobox",haspopup:"listbox","aria-expanded":"false","aria-controls":m});f=getId(c,n.inputId+"-tomselected");let O="label[for='"+escapeQuery(n.inputId)+"']";let b=document.querySelector(O);if(b){setAttr(b,{for:f});let e=getId(b,n.inputId+"-ts-label");setAttr(u,{"aria-labelledby":e})}n.settings.copyClassesToDropdown&&addClasses(d,h);l.style.width=s.style.width;if(n.plugins.names.length){g="plugin-"+n.plugins.names.join(" plugin-");addClasses([l,d],g)}(null===t.maxItems||t.maxItems>1)&&n.is_select_tag&&setAttr(s,{multiple:"multiple"});n.settings.placeholder&&setAttr(c,{placeholder:t.placeholder});!n.settings.splitOn&&n.settings.delimiter&&(n.settings.splitOn=new RegExp("\\s*"+escape_regex(n.settings.delimiter)+"+\\s*"));this.settings.load&&this.settings.loadThrottle&&(this.settings.load=loadDebounce(this.settings.load,this.settings.loadThrottle));this.control=a;this.control_input=c;this.wrapper=l;this.dropdown=d;this.dropdown_content=u;n.control_input.type=s.type;addEvent(d,"click",(e=>{const t=parentMatch(e.target,"[data-selectable]");if(t){n.onOptionSelect(e,t);preventDefault(e,true)}}));addEvent(a,"click",(e=>{var t=parentMatch(e.target,"."+n.settings.itemClass,a);if(t&&n.onItemSelect(e,t))preventDefault(e,true);else if(""==c.value){n.onClick();preventDefault(e,true)}}));addEvent(c,"mousedown",(e=>{""!==c.value&&e.stopPropagation()}));addEvent(c,"keydown",(e=>n.onKeyDown(e)));addEvent(c,"keyup",(e=>n.onKeyUp(e)));addEvent(c,"keypress",(e=>n.onKeyPress(e)));addEvent(c,"resize",(()=>n.positionDropdown()),v);addEvent(c,"blur",(()=>n.onBlur()));addEvent(c,"focus",(e=>n.onFocus(e)));addEvent(c,"paste",(e=>n.onPaste(e)));const doc_mousedown=e=>{const t=e.composedPath()[0];if(l.contains(t)||d.contains(t))preventDefault(e,true);else{n.isFocused&&n.blur();n.inputState()}};var win_scroll=()=>{n.isOpen&&n.positionDropdown()};addEvent(document,"mousedown",doc_mousedown);addEvent(window,"sroll",win_scroll,v);addEvent(window,"resize",win_scroll,v);this._destroy=()=>{document.removeEventListener("mousedown",doc_mousedown);window.removeEventListener("sroll",win_scroll);window.removeEventListener("resize",win_scroll)};this.revertSettings={innerHTML:s.innerHTML,tabIndex:s.tabIndex};s.tabIndex=-1;setAttr(s,{hidden:"hidden"});s.insertAdjacentElement("afterend",n.wrapper);n.setValue(t.items);t.items=[];addEvent(s,"invalid",(e=>{preventDefault(e);if(!n.isInvalid){n.isInvalid=true;n.refreshState()}}));n.updateOriginalInput();n.refreshItems();n.close(false);n.inputState();n.isSetup=true;s.disabled&&n.disable();n.on("change",this.onChange);addClasses(s,"tomselected");n.trigger("initialize");true===t.preload&&n.load("");n.setup()}
/**
     * @deprecated v1.7.6
     *
     */setup(){}setupOptions(e=[],t=[]){for(const t of e)this.registerOption(t);for(const e of t)this.registerOptionGroup(e)}setupTemplates(){var e=this;var t=e.settings.labelField;var i=e.settings.optgroupLabelField;var s={optgroup:e=>{let t=document.createElement("div");t.className="optgroup";t.appendChild(e.options);return t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[i])+"</div>",option:(e,i)=>"<div>"+i(e[t])+"</div>",item:(e,i)=>"<div>"+i(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},s,e.settings.render)}setupCallbacks(){var e,t;var i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i){t=this.settings[i[e]];t&&this.on(e,t)}}onClick(){var e=this;if(e.activeItems.length>0){e.clearActiveItems();e.focus()}else e.isFocused&&e.isOpen?e.blur():e.focus()}
/**
     * @deprecated v1.7
     *
     */onMouseDown(){}onChange(){triggerEvent(this.input,"input");triggerEvent(this.input,"change")}onPaste(e){var t=this;t.isFull()||t.isInputHidden||t.isLocked?preventDefault(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var i=e.trim().split(t.settings.splitOn);for(const e of i)t.createItem(e)}}),0)}onKeyPress(e){var t=this;if(t.isLocked)preventDefault(e);else{var i=String.fromCharCode(e.keyCode||e.which);if(t.settings.create&&"multi"===t.settings.mode&&i===t.settings.delimiter){t.createItem();preventDefault(e)}else;}}onKeyDown(e){var t=this;if(t.isLocked)e.keyCode!==m&&preventDefault(e);else{switch(e.keyCode){case a:if(isKeyDown(O,e)){t.selectAll();return}break;case d:if(t.isOpen){preventDefault(e,true);t.close()}t.clearActiveItems();return;case g:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1);e&&t.setActiveOption(e)}preventDefault(e);return;case p:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1);e&&t.setActiveOption(e)}preventDefault(e);return;case c:if(t.isOpen&&t.activeOption){t.onOptionSelect(e,t.activeOption);preventDefault(e)}else t.settings.create&&t.createItem()&&preventDefault(e);return;case u:t.advanceSelection(-1,e);return;case h:t.advanceSelection(1,e);return;case m:if(t.settings.selectOnTab){if(t.isOpen&&t.activeOption){t.tab_key=true;t.onOptionSelect(e,t.activeOption);preventDefault(e);t.tab_key=false}t.settings.create&&t.createItem()&&preventDefault(e)}return;case f:case v:t.deleteSelection(e);return}t.isInputHidden&&!isKeyDown(O,e)&&preventDefault(e)}}onKeyUp(e){var t=this;if(t.isLocked)preventDefault(e);else{var i=t.inputValue();if(t.lastValue!==i){t.lastValue=i;t.settings.shouldLoad.call(t,i)&&t.load(i);t.refreshOptions();t.trigger("type",i)}}}onFocus(e){var t=this;var i=t.isFocused;if(t.isDisabled){t.blur();preventDefault(e)}else if(!t.ignoreFocus){t.isFocused=true;"focus"===t.settings.preload&&t.load("");i||t.trigger("focus");if(!t.activeItems.length){t.showInput();t.refreshOptions(!!t.settings.openOnFocus)}t.refreshState()}}onBlur(){var e=this;if(e.isFocused){e.isFocused=false;e.ignoreFocus=false;var deactivate=()=>{e.close();e.setActiveItem();e.setCaret(e.items.length);e.trigger("blur")};e.settings.create&&e.settings.createOnBlur?e.createItem(null,false,deactivate):deactivate()}}onOptionSelect(e,t){var i,s=this;if(t&&(!t.parentElement||!t.parentElement.matches("[data-disabled]")))if(t.classList.contains("create"))s.createItem(null,true,(()=>{s.settings.closeAfterSelect&&s.close()}));else{i=t.dataset.value;if("undefined"!==typeof i){s.lastQuery=null;s.addItem(i);s.settings.closeAfterSelect&&s.close();!s.settings.hideSelected&&e.type&&/click/.test(e.type)&&s.setActiveOption(t)}}}onItemSelect(e,t){var i=this;if(!i.isLocked&&"multi"===i.settings.mode){preventDefault(e);i.setActiveItem(t,e);return true}return false}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){const t=this;if(!t.canLoad(e))return;addClasses(t.wrapper,t.settings.loadingClass);t.loading++;const i=t.loadCallback.bind(t);t.settings.load.call(t,e,i)}loadCallback(e,t){const i=this;i.loading=Math.max(i.loading-1,0);i.lastQuery=null;i.clearActiveOption();i.setupOptions(e,t);i.refreshOptions(i.isFocused&&!i.isInputHidden);i.loading||removeClasses(i.wrapper,i.settings.loadingClass);i.trigger("load",e,t)}setTextboxValue(e=""){var t=this.control_input;var i=t.value!==e;if(i){t.value=e;triggerEvent(t,"update");this.lastValue=e}}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){var i=t?[]:["change"];debounce_events(this,i,(()=>{this.clear(t);this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null);this.settings.maxItems=e;this.refreshState()}setActiveItem(e,t){var i=this;var s;var n,r,o,l;var a;if("single"!==i.settings.mode)if(e){s=t&&t.type.toLowerCase();if("click"===s&&isKeyDown("shiftKey",t)&&i.activeItems.length){a=i.getLastActive();r=Array.prototype.indexOf.call(i.control.children,a);o=Array.prototype.indexOf.call(i.control.children,e);if(r>o){l=r;r=o;o=l}for(n=r;n<=o;n++){e=i.control.children[n];-1===i.activeItems.indexOf(e)&&i.setActiveItemClass(e)}preventDefault(t)}else if("click"===s&&isKeyDown(O,t)||"keydown"===s&&isKeyDown("shiftKey",t))e.classList.contains("active")?i.removeActiveItem(e):i.setActiveItemClass(e);else{i.clearActiveItems();i.setActiveItemClass(e)}i.hideInput();i.isFocused||i.focus()}else{i.clearActiveItems();i.isFocused&&i.showInput()}}setActiveItemClass(e){const t=this;const i=t.control.querySelector(".last-active");i&&removeClasses(i,"last-active");addClasses(e,"active last-active");t.trigger("item_select",e);-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1);removeClasses(e,"active")}clearActiveItems(){removeClasses(this.activeItems,"active");this.activeItems=[]}setActiveOption(e){if(e!==this.activeOption){this.clearActiveOption();if(e){this.activeOption=e;setAttr(this.control_input,{"aria-activedescendant":e.getAttribute("id")});setAttr(e,{"aria-selected":"true"});addClasses(e,"active");this.scrollToOption(e)}}}scrollToOption(e,t){if(!e)return;const i=this.dropdown_content;const s=i.clientHeight;const n=i.scrollTop||0;const r=e.offsetHeight;const o=e.getBoundingClientRect().top-i.getBoundingClientRect().top+n;o+r>s+n?this.scroll(o-s+r,t):o<n&&this.scroll(o,t)}scroll(e,t){const i=this.dropdown_content;t&&(i.style.scrollBehavior=t);i.scrollTop=e;i.style.scrollBehavior=""}clearActiveOption(){if(this.activeOption){removeClasses(this.activeOption,"active");setAttr(this.activeOption,{"aria-selected":null})}this.activeOption=null;setAttr(this.control_input,{"aria-activedescendant":null})}selectAll(){if("single"!==this.settings.mode){this.activeItems=this.controlChildren();if(this.activeItems.length){addClasses(this.activeItems,"active");this.hideInput();this.close()}this.focus()}}inputState(){var e=this;if(!e.settings.controlInput)if(e.activeItems.length>0||!e.isFocused&&this.settings.hidePlaceholder&&e.items.length>0){e.setTextboxValue();e.isInputHidden=true;addClasses(e.wrapper,"input-hidden")}else{e.isInputHidden=false;removeClasses(e.wrapper,"input-hidden")}}
/**
     * Hides the input element out of view, while
     * retaining its focus.
     * @deprecated 1.3
     */hideInput(){this.inputState()}
/**
     * Restores input visibility.
     * @deprecated 1.3
     */showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var e=this;if(!e.isDisabled){e.ignoreFocus=true;e.control_input.focus();setTimeout((()=>{e.ignoreFocus=false;e.onFocus()}),0)}}blur(){this.control_input.blur();this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings;var t=e.sortField;"string"===typeof e.sortField&&(t=[{field:e.sortField}]);return{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,s;var n=this;var r=this.getSearchOptions();if(n.settings.score){s=n.settings.score.call(n,e);if("function"!==typeof s)throw new Error('Tom Select "score" setting must be a function that returns a function')}if(e!==n.lastQuery){n.lastQuery=e;i=n.sifter.search(e,Object.assign(r,{score:s}));n.currentResults=i}else i=Object.assign({},n.currentResults);if(n.settings.hideSelected)for(t=i.items.length-1;t>=0;t--){let e=hash_key(i.items[t].id);e&&-1!==n.items.indexOf(e)&&i.items.splice(t,1)}return i}refreshOptions(e=true){var t,i,s,n,r,o,l,a,c,d;var u;const p={};const h=[];var g=this;var f=g.inputValue();var v=g.search(f);var m=g.activeOption;var y=g.settings.shouldOpen||false;var O=g.dropdown_content;if(m){c=m.dataset.value;d=m.closest("[data-group]")}n=v.items.length;"number"===typeof g.settings.maxOptions&&(n=Math.min(n,g.settings.maxOptions));n>0&&(y=true);for(t=0;t<n;t++){let e=v.items[t].id;let n=g.options[e];let l=g.getOption(e,true);g.settings.hideSelected||l.classList.toggle("selected",g.items.includes(e));r=n[g.settings.optgroupField]||"";o=Array.isArray(r)?r:[r];for(i=0,s=o&&o.length;i<s;i++){r=o[i];g.optgroups.hasOwnProperty(r)||(r="");if(!p.hasOwnProperty(r)){p[r]=document.createDocumentFragment();h.push(r)}if(i>0){l=l.cloneNode(true);setAttr(l,{id:n.$id+"-clone-"+i,"aria-selected":null});l.classList.add("ts-cloned");removeClasses(l,"active")}c==e&&d&&d.dataset.group===r&&(m=l);p[r].appendChild(l)}}this.settings.lockOptgroupOrder&&h.sort(((e,t)=>{var i=g.optgroups[e]&&g.optgroups[e].$order||0;var s=g.optgroups[t]&&g.optgroups[t].$order||0;return i-s}));l=document.createDocumentFragment();for(r of h)if(g.optgroups.hasOwnProperty(r)&&p[r].children.length){let e=document.createDocumentFragment();let t=g.render("optgroup_header",g.optgroups[r]);append(e,t);append(e,p[r]);let i=g.render("optgroup",{group:g.optgroups[r],options:e});append(l,i)}else append(l,p[r]);O.innerHTML="";append(O,l);if(g.settings.highlight){removeHighlight(O);if(v.query.length&&v.tokens.length)for(const e of v.tokens)highlight(O,e.regex)}var add_template=e=>{let t=g.render(e,{input:f});if(t){y=true;O.insertBefore(t,O.firstChild)}return t};g.settings.shouldLoad.call(g,f)?g.loading?add_template("loading"):0===v.items.length&&add_template("no_results"):add_template("not_loading");a=g.canCreate(f);a&&(u=add_template("option_create"));g.hasOptions=v.items.length>0||a;if(y){if(v.items.length>0){!O.contains(m)&&"single"===g.settings.mode&&g.items.length&&(m=g.getOption(g.items[0]));if(!O.contains(m)){let e=0;u&&!g.settings.addPrecedence&&(e=1);m=g.selectable()[e]}}else u&&(m=u);if(e&&!g.isOpen){g.open();g.scrollToOption(m,"auto")}g.setActiveOption(m)}else{g.clearActiveOption();e&&g.isOpen&&g.close(false)}}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e){var t,i=this;if(Array.isArray(e))for(const t of e)i.addOption(t);else if(t=i.registerOption(e)){i.userOptions[t]=true;i.lastQuery=null;i.trigger("option_add",t,e)}}registerOption(e){var t=hash_key(e[this.settings.valueField]);if(null===t||this.options.hasOwnProperty(t))return false;e.$order=e.$order||++this.order;e.$id=this.inputId+"-opt-"+e.$order;this.options[t]=e;return t}registerOptionGroup(e){var t=hash_key(e[this.settings.optgroupValueField]);if(null===t)return false;e.$order=e.$order||++this.order;this.optgroups[t]=e;return t}addOptionGroup(e,t){var i;t[this.settings.optgroupValueField]=e;(i=this.registerOptionGroup(t))&&this.trigger("optgroup_add",i,t)}removeOptionGroup(e){if(this.optgroups.hasOwnProperty(e)){delete this.optgroups[e];this.clearCache();this.trigger("optgroup_remove",e)}}clearOptionGroups(){this.optgroups={};this.clearCache();this.trigger("optgroup_clear")}updateOption(e,t){const i=this;var s;var n;const r=hash_key(e);if(null===r)return;const o=hash_key(t[i.settings.valueField]);const l=i.getOption(r);const a=i.getItem(r);if(i.options.hasOwnProperty(r)){if("string"!==typeof o)throw new Error("Value must be set in option data");t.$order=t.$order||i.options[r].$order;delete i.options[r];i.uncacheValue(o);i.uncacheValue(r,false);i.options[o]=t;if(l){if(i.dropdown_content.contains(l)){const e=i._render("option",t);replaceNode(l,e);i.activeOption===l&&i.setActiveOption(e)}l.remove()}if(a){n=i.items.indexOf(r);-1!==n&&i.items.splice(n,1,o);s=i._render("item",t);a.classList.contains("active")&&addClasses(s,"active");replaceNode(a,s)}i.lastQuery=null}}removeOption(e,t){const i=this;e=get_hash(e);i.uncacheValue(e);delete i.userOptions[e];delete i.options[e];i.lastQuery=null;i.trigger("option_remove",e);i.removeItem(e,t)}clearOptions(){this.loadedSearches={};this.userOptions={};this.clearCache();var e={};for(let t in this.options)this.options.hasOwnProperty(t)&&this.items.indexOf(t)>=0&&(e[t]=this.options[t]);this.options=this.sifter.items=e;this.lastQuery=null;this.trigger("option_clear")}uncacheValue(e,t=true){const i=this;const s=i.renderCache.item;const n=i.renderCache.option;s&&delete s[e];n&&delete n[e];if(t){const t=i.getOption(e);t&&t.remove()}}getOption(e,t=false){var i=hash_key(e);var s=this.rendered("option",i);!s&&t&&null!==i&&(s=this._render("option",this.options[i]));return s}getAdjacent(e,t,i="option"){var s,n=this;if(!e)return null;s="item"==i?n.controlChildren():n.dropdown_content.querySelectorAll("[data-selectable]");for(let i=0;i<s.length;i++)if(s[i]==e)return t>0?s[i+1]:s[i-1];return null}getItem(e){if("object"==typeof e)return e;var t=hash_key(e);return null!==t?this.control.querySelector(`[data-value="${addSlashes(t)}"]`):null}addItems(e,t){var i=this;var s=Array.isArray(e)?e:[e];s=s.filter((e=>-1===i.items.indexOf(e)));for(let e=0,n=s.length;e<n;e++){i.isPending=e<n-1;i.addItem(s[e],t)}}addItem(e,t){var i=t?[]:["change"];debounce_events(this,i,(()=>{var i,s;const n=this;const r=n.settings.mode;const o=hash_key(e);if(o&&-1!==n.items.indexOf(o)){"single"===r&&n.close();if("single"===r||!n.settings.duplicates)return}if(null!==o&&n.options.hasOwnProperty(o)){"single"===r&&n.clear(t);if("multi"!==r||!n.isFull()){i=n._render("item",n.options[o]);n.control.contains(i)&&(i=i.cloneNode(true));s=n.isFull();n.items.splice(n.caretPos,0,o);n.insertAtCaret(i);if(n.isSetup){let e=n.selectable();if(!n.isPending&&n.settings.hideSelected){let e=n.getOption(o);let t=n.getAdjacent(e,1);t&&n.setActiveOption(t)}n.isPending||n.refreshOptions(n.isFocused&&"single"!==r);!e.length||n.isFull()?n.close():n.isPending||n.positionDropdown();n.trigger("item_add",o,i);n.isPending||n.updateOriginalInput({silent:t})}(!n.isPending||!s&&n.isFull())&&n.refreshState()}}}))}removeItem(e=null,t){const i=this;e=i.getItem(e);if(!e)return;var s,n;const r=e.dataset.value;s=nodeIndex(e);e.remove();if(e.classList.contains("active")){n=i.activeItems.indexOf(e);i.activeItems.splice(n,1);removeClasses(e,"active")}i.items.splice(s,1);i.lastQuery=null;!i.settings.persist&&i.userOptions.hasOwnProperty(r)&&i.removeOption(r,t);s<i.caretPos&&i.setCaret(i.caretPos-1);i.updateOriginalInput({silent:t});i.refreshState();i.positionDropdown();i.trigger("item_remove",r,e)}createItem(e=null,t=true,i=(()=>{})){var s=this;var n=s.caretPos;var r;e=e||s.inputValue();if(!s.canCreate(e)){i();return false}s.lock();var o=false;var create=e=>{s.unlock();if(!e||"object"!==typeof e)return i();var r=hash_key(e[s.settings.valueField]);if("string"!==typeof r)return i();s.setTextboxValue();s.addOption(e);s.setCaret(n);s.addItem(r);s.refreshOptions(t&&"single"!==s.settings.mode);i(e);o=true};r="function"===typeof s.settings.create?s.settings.create.call(this,e,create):{[s.settings.labelField]:e,[s.settings.valueField]:e};o||create(r);return true}refreshItems(){var e=this;e.lastQuery=null;e.isSetup&&e.addItems(e.items);e.updateOriginalInput();e.refreshState()}refreshState(){var e=this;e.refreshValidityState();var t=e.isFull();var i=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);var s=e.control.classList;s.toggle("focus",e.isFocused);s.toggle("disabled",e.isDisabled);s.toggle("required",e.isRequired);s.toggle("invalid",e.isInvalid);s.toggle("locked",i);s.toggle("full",t);s.toggle("not-full",!t);s.toggle("input-active",e.isFocused&&!e.isInputHidden);s.toggle("dropdown-active",e.isOpen);s.toggle("has-options",isEmptyObject(e.options));s.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;if(e.input.checkValidity){this.isRequired&&(e.input.required=true);var t=!e.input.checkValidity();e.isInvalid=t;e.control_input.required=t;this.isRequired&&(e.input.required=!t)}}
/**
     * Determines whether or not more items can be added
     * to the control without exceeding the user-defined maximum.
     *
     * @returns {boolean}
     */isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var i,s,n,r,o;if(t.is_select_tag){const e=[];function AddSelected(i,s,n){i||(i=getDom('<option value="'+escape_html(s)+'">'+escape_html(n)+"</option>"));t.input.prepend(i);e.push(i);setAttr(i,{selected:"true"});i.selected=true;return i}t.input.querySelectorAll("option[selected]").forEach((e=>{setAttr(e,{selected:null});e.selected=false}));if(0!=t.items.length||"single"!=t.settings.mode||t.isRequired)for(i=t.items.length-1;i>=0;i--){s=t.items[i];n=t.options[s];o=n[t.settings.labelField]||"";if(e.includes(n.$option)){const e=t.input.querySelector(`option[value="${addSlashes(s)}"]:not([selected])`);AddSelected(e,s,o)}else n.$option=AddSelected(n.$option,s,o)}else{r=t.input.querySelector('option[value=""]');AddSelected(r,"","")}}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;if(!(e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull())){e.isOpen=true;setAttr(e.control_input,{"aria-expanded":"true"});e.refreshState();applyCSS(e.dropdown,{visibility:"hidden",display:"block"});e.positionDropdown();applyCSS(e.dropdown,{visibility:"visible",display:"block"});e.focus();e.trigger("dropdown_open",e.dropdown)}}close(e=true){var t=this;var i=t.isOpen;if(e){t.setTextboxValue();if("single"===t.settings.mode&&t.items.length){t.hideInput();t.tab_key||t.blur()}}t.isOpen=false;setAttr(t.control_input,{"aria-expanded":"false"});applyCSS(t.dropdown,{display:"none"});t.settings.hideSelected&&t.clearActiveOption();t.refreshState();i&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control;var t=e.getBoundingClientRect();var i=e.offsetHeight+t.top+window.scrollY;var s=t.left+window.scrollX;applyCSS(this.dropdown,{width:t.width+"px",top:i+"px",left:s+"px"})}}clear(e){var t=this;if(t.items.length){var i=t.controlChildren();for(const e of i)t.removeItem(e,true);t.showInput();e||t.updateOriginalInput();t.trigger("clear")}}insertAtCaret(e){var t=this;var i=Math.min(t.caretPos,t.items.length);var s=t.control;0===i?s.insertBefore(e,s.firstChild):s.insertBefore(e,s.children[i]);t.setCaret(i+1)}deleteSelection(e){var t,i,s,n;var r=this;t=e&&e.keyCode===f?-1:1;i=getSelection(r.control_input);const o=[];if(r.activeItems.length){n=getTail(r.activeItems,t);s=nodeIndex(n);t>0&&s++;for(const e of r.activeItems)o.push(e)}else if((r.isFocused||"single"===r.settings.mode)&&r.items.length){const e=r.controlChildren();t<0&&0===i.start&&0===i.length?o.push(e[r.caretPos-1]):t>0&&i.start===r.inputValue().length&&o.push(e[r.caretPos])}const l=o.map((e=>e.dataset.value));if(!l.length||"function"===typeof r.settings.onDelete&&false===r.settings.onDelete.call(r,l,e))return false;preventDefault(e,true);"undefined"!==typeof s&&r.setCaret(s);while(o.length)r.removeItem(o.pop());r.showInput();r.positionDropdown();r.refreshOptions(false);return true}advanceSelection(e,t){var i,s,n,r=this;r.rtl&&(e*=-1);if(!r.inputValue().length)if(isKeyDown(O,t)||isKeyDown("shiftKey",t)){s=r.getLastActive(e);n=s?s.classList.contains("active")?r.getAdjacent(s,e,"item"):s:e>0?r.control_input.nextElementSibling:r.control_input.previousElementSibling;if(n){n.classList.contains("active")&&r.removeActiveItem(s);r.setActiveItemClass(n)}}else if(r.isFocused&&!r.activeItems.length)r.setCaret(r.caretPos+e);else{s=r.getLastActive(e);if(s){i=nodeIndex(s);r.setCaret(e>0?i+1:i);r.setActiveItem()}}}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var i=this.control.querySelectorAll(".active");return i?getTail(i,e):void 0}setCaret(e){var t=this;if("single"===t.settings.mode||t.settings.controlInput)e=t.items.length;else{e=Math.max(0,Math.min(t.items.length,e));e==t.caretPos||t.isPending||t.controlChildren().forEach(((i,s)=>{s<e?t.control_input.insertAdjacentElement("beforebegin",i):t.control.appendChild(i)}))}t.caretPos=e}controlChildren(){return Array.from(this.control.getElementsByClassName(this.settings.itemClass))}lock(){this.close();this.isLocked=true;this.refreshState()}unlock(){this.isLocked=false;this.refreshState()}disable(){var e=this;e.input.disabled=true;e.control_input.disabled=true;e.control_input.tabIndex=-1;e.isDisabled=true;e.lock()}enable(){var e=this;e.input.disabled=false;e.control_input.disabled=false;e.control_input.tabIndex=e.tabIndex;e.isDisabled=false;e.unlock()}destroy(){var e=this;var t=e.revertSettings;e.trigger("destroy");e.off();e.wrapper.remove();e.dropdown.remove();e.input.innerHTML=t.innerHTML;e.input.tabIndex=t.tabIndex;removeClasses(e.input,"tomselected");setAttr(e.input,{hidden:null});e.input.required=this.isRequired;e._destroy();delete e.input.tomselect}render(e,t){return"function"!==typeof this.settings.render[e]?null:this._render(e,t)}_render(e,t){var i,s,n="";const r=this;if("option"===e||"item"===e){n=get_hash(t[r.settings.valueField]);s=r.rendered(e,n);if(s)return s}s=r.settings.render[e].call(this,t,escape_html);if(null==s)return s;s=getDom(s);if("option"===e||"option_create"===e)t[r.settings.disabledField]?setAttr(s,{"aria-disabled":"true"}):setAttr(s,{"data-selectable":""});else if("optgroup"===e){i=t.group[r.settings.optgroupValueField];setAttr(s,{"data-group":i});t.group[r.settings.disabledField]&&setAttr(s,{"data-disabled":""})}if("option"===e||"item"===e){setAttr(s,{"data-value":n});if("item"===e)addClasses(s,r.settings.itemClass);else{addClasses(s,r.settings.optionClass);setAttr(s,{role:"option",id:t.$id})}r.renderCache[e][n]=s}return s}rendered(e,t){return null!==t&&this.renderCache[e].hasOwnProperty(t)?this.renderCache[e][t]:null}clearCache(e){var t=this;if(void 0===e||"option")for(let e in t.options){const i=t.getOption(e);i&&i.remove()}void 0===e?t.renderCache={item:{},option:{}}:t.renderCache[e]={}}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,i){var s=this;var n=s[t];s[t]=function(){var t,r;"after"===e&&(t=n.apply(s,arguments));r=i.apply(s,arguments);if("instead"===e)return r;"before"===e&&(t=n.apply(s,arguments));return t}}}TomSelect.define("change_listener",(function(){const t=this||e;const joined=e=>e.join(t.settings.delimiter);addEvent(t.input,"change",(()=>{var e=getSettings(t.input,{delimiter:t.settings.delimiter});if(joined(t.items)!=joined(e.items)){t.setupOptions(e.options,e.optgroups);t.setValue(e.items)}}))}));TomSelect.define("checkbox_options",(function(){var t=this||e;var i=t.onOptionSelect;t.settings.hideSelected=false;var s=function UpdateCheckbox(e){setTimeout((()=>{var t=e.querySelector("input");e.classList.contains("selected")?t.checked=true:t.checked=false}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(i,s)=>{var n=getDom(e.call(t,i,s));var r=document.createElement("input");r.addEventListener("click",(function(e){preventDefault(e)}));r.type="checkbox";const o=hash_key(i[t.settings.valueField]);o&&t.items.indexOf(o)>-1&&(r.checked=true);n.prepend(r);return n}}));t.on("item_remove",(e=>{var i=t.getOption(e);if(i){i.classList.remove("selected");s(i)}}));t.hook("instead","onOptionSelect",((e,n)=>{if(n.classList.contains("selected")){n.classList.remove("selected");t.removeItem(n.dataset.value);t.refreshOptions();preventDefault(e,true)}else{i.call(t,e,n);s(n)}}))}));TomSelect.define("clear_button",(function(t){const i=this||e;const s=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&times;</div>`},t);i.on("initialize",(()=>{var e=getDom(s.html(s));e.addEventListener("click",(e=>{i.clear();e.preventDefault();e.stopPropagation()}));i.control.appendChild(e)}))}));TomSelect.define("drag_drop",(function(){var t=this||e;if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===t.settings.mode){var i=t.lock;var s=t.unlock;t.hook("instead","lock",(()=>{var e=$(t.control).data("sortable");e&&e.disable();return i.call(t)}));t.hook("instead","unlock",(()=>{var e=$(t.control).data("sortable");e&&e.enable();return s.call(t)}));t.on("initialize",(()=>{var i=$(t.control).sortable({items:"[data-value]",forcePlaceholderSize:true,disabled:t.isLocked,start:(e,t)=>{t.placeholder.css("width",t.helper.css("width"));i.css({overflow:"visible"})},stop:()=>{i.css({overflow:"hidden"});var s=[];i.children("[data-value]").each((function(){(this||e).dataset.value&&s.push((this||e).dataset.value)}));t.setValue(s)}})}))}}));TomSelect.define("dropdown_header",(function(t){const i=this||e;const s=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},t);i.on("initialize",(()=>{var e=getDom(s.html(s));var t=e.querySelector("."+s.closeClass);t&&t.addEventListener("click",(e=>{preventDefault(e,true);i.close()}));i.dropdown.insertBefore(e,i.dropdown.firstChild)}))}));TomSelect.define("dropdown_input",(function(){var t=this||e;var i=t.settings.controlInput||'<input type="text" autocomplete="off" class="dropdown-input" />';i=getDom(i);t.settings.placeholder&&setAttr(i,{placeholder:t.settings.placeholder});t.settings.controlInput=i;t.settings.shouldOpen=true;t.on("initialize",(()=>{addEvent(t.wrapper,"focus",(e=>{t.onFocus(e)}));const setTabIndex=()=>{setAttr(t.wrapper,{tabindex:t.input.disabled?"-1":t.tabIndex})};t.on("dropdown_close",setTabIndex);t.on("dropdown_open",(()=>setAttr(t.wrapper,{tabindex:"-1"})));setTabIndex();addEvent(t.wrapper,"keypress",(e=>{if(!t.control.contains(e.target)&&!t.dropdown.contains(e.target))switch(e.keyCode){case c:t.onClick();return}}));let e=getDom('<div class="dropdown-input-wrap">');e.appendChild(i);t.dropdown.insertBefore(e,t.dropdown.firstChild)}))}));TomSelect.define("input_autogrow",(function(){var t=this||e;t.on("initialize",(()=>{var e=document.createElement("span");var i=t.control_input;e.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ";t.wrapper.appendChild(e);var s=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const t of s)e.style[t]=i.style[t];var resize=()=>{if(t.items.length>0){e.textContent=i.value;i.style.width=e.clientWidth+"px"}else i.style.width=""};resize();t.on("update item_add item_remove",resize);addEvent(i,"input",resize);addEvent(i,"keyup",resize);addEvent(i,"blur",resize);addEvent(i,"update",resize)}))}));TomSelect.define("no_backspace_delete",(function(){var t=this||e;var i=t.deleteSelection;this.hook("instead","deleteSelection",(e=>!!t.activeItems.length&&i.call(t,e)))}));TomSelect.define("no_active_items",(function(){this.hook("instead","setActiveItem",(()=>{}));this.hook("instead","selectAll",(()=>{}))}));TomSelect.define("optgroup_columns",(function(){var t=this||e;var i=t.onKeyDown;t.hook("instead","onKeyDown",(e=>{var s,n,r,o;if(!t.isOpen||!(e.keyCode===u||e.keyCode===h))return i.call(t,e);o=parentMatch(t.activeOption,"[data-group]");s=nodeIndex(t.activeOption,"[data-selectable]");if(o){o=e.keyCode===u?o.previousSibling:o.nextSibling;if(o){r=o.querySelectorAll("[data-selectable]");n=r[Math.min(r.length-1,s)];n&&t.setActiveOption(n)}}}))}));TomSelect.define("remove_button",(function(t){const i=Object.assign({label:"&times;",title:"Remove",className:"remove",append:true},t);var s=this||e;if(i.append){var n='<a href="javascript:void(0)" class="'+i.className+'" tabindex="-1" title="'+escape_html(i.title)+'">'+i.label+"</a>";s.hook("after","setupTemplates",(()=>{var e=s.settings.render.item;s.settings.render.item=(t,i)=>{var r=getDom(e.call(s,t,i));var o=getDom(n);r.appendChild(o);addEvent(o,"mousedown",(e=>{preventDefault(e,true)}));addEvent(o,"click",(e=>{preventDefault(e,true);if(!s.isLocked){var t=r.dataset.value;s.removeItem(t);s.refreshOptions(false)}}));return r}}))}}));TomSelect.define("restore_on_backspace",(function(t){const i=this||e;const s=Object.assign({text:e=>e[i.settings.labelField]},t);i.on("item_remove",(function(e){if(""===i.control_input.value.trim()){var t=i.options[e];t&&i.setTextboxValue(s.text.call(i,t))}}))}));TomSelect.define("virtual_scroll",(function(){const t=this||e;const i=t.canLoad;const s=t.clearActiveOption;const n=t.loadCallback;var r={};var o;var l=false;if(!t.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";t.settings.sortField=[{field:"$order"},{field:"$score"}];function canLoadMore(e){return!("number"===typeof t.settings.maxOptions&&o.children.length>=t.settings.maxOptions)&&!(!(e in r)||!r[e])}t.setNextUrl=function(e,t){r[e]=t};t.getUrl=function(e){if(e in r){const t=r[e];r[e]=false;return t}r={};return t.settings.firstUrl(e)};t.hook("instead","clearActiveOption",(()=>{if(!l)return s.call(t)}));t.hook("instead","canLoad",(e=>e in r?canLoadMore(e):i.call(t,e)));t.hook("instead","loadCallback",((e,i)=>{l||t.clearOptions();n.call(t,e,i);l=false}));t.hook("after","refreshOptions",(()=>{const e=t.lastValue;var i;if(canLoadMore(e)){i=t.render("loading_more",{query:e});i&&i.setAttribute("data-selectable","")}else e in r&&!o.querySelector(".no-results")&&(i=t.render("no_more_results",{query:e}));if(i){addClasses(i,t.settings.optionClass);o.append(i)}}));t.on("initialize",(()=>{o=t.dropdown_content;t.settings.render=Object.assign({},{loading_more:function(){return'<div class="loading-more-results">Loading more results ... </div>'},no_more_results:function(){return'<div class="no-more-results">No more results</div>'}},t.settings.render);o.addEventListener("scroll",(function(){const e=o.clientHeight/(o.scrollHeight-o.scrollTop);if(!(e<.95)&&canLoadMore(t.lastValue)&&!l){l=true;t.load.call(t,t.lastValue)}}))}))}));return TomSelect}));var i=t;export default i;

